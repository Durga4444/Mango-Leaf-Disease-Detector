<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mango Leaf Disease Detection</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cabin:wght@400;500;600;700&family=Calistoga&display=swap"
        rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
 
<style>
    *{
    margin:0px;
    padding:0px;
}

#body{
  font-family: "EB Garamond", serif;
  font-weight: 100px;
  font-style: normal; 
  height:100%;
  width:100%;
  background-color: aquamarine;
}

#logged-out-view{
    box-sizing:border-box;
    height:100%;
    display:flex;
    justify-content:center;
}
.con{
    width:400px;
    gap:3em;
    
}
.provider-buttons{
    margin-bottom:15px;
    width:100%;
}
.con h1{
    margin-bottom:40px;
    margin-top:40px;
}
input,.con button{
    outline:none;
    border-radius:15px;
    border:0;
    background-color:white
}

.container2 {
    margin-top: 50px;
    max-width: 500px;
    text-align: center;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    background-color: white;
}
.container2 h1 {
    font-size: 2.5rem;
    color: #198754;
}
.container2 button {
    margin-top: 20px;
    background-color: #198754;
    color: white;
}
.container2 button:hover {
    background-color: #157347;
}
.container3 h1{
margin-bottom:10px;
}
#greet{
    display:inline-block;
    color:pink;
    margin-bottom:20px;
}
#h{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
} 

:root {
    --border-width: 3px;
    --element-border-radius: 5px;
    --button-height: 5px;
    --small-button-height: 2px;
    --element-padding: 0.8em;
}

html {
    margin: 0;
    padding: 0;
    font-size: 16px;
    
}
h1 {
    margin: 0;
}

.app-title {

    font-size: 2.5em;
    text-align: center;
}

/* === Sections === */

.auth-fields-and-buttons {
    display: flex;
    flex-direction: column;
    gap: 1em;
    
}

#email-input,#password-input,#sign-in-btn,#create-account-btn{
    box-shadow: 3px 3px 3px 1px rgba(0, 0, 0, .25);   
}
#email-input:hover{
    box-shadow: 0px 0px 0px 0px rgba(0, 0, 0, .25); 
    border:1px solid green
}
#password-input:hover{
    box-shadow: 0px 0px 0px 0px rgba(0, 0, 0, .25); 
    border:1px solid green
}

/* === Structure === */

.pro-log{
    display:flex;
    justify-content:end;
    align-items:center;
}

#profile-img{
    border-radius:50%;
    height:50px;
    width:50px;
}
/* === Common for elements === */

input, button {
    font-family: inherit;
    padding: var(--element-padding);
    box-sizing: border-box;
    font-size: 1.1em;
    text-align: center;
}

input:focus, button:focus {
    outline: none;
}

/* === Input fields === */

input {
    font-weight: 300;
}

input::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
   
    opacity: 1; /* Firefox */
}

/* === Buttons === */

button {
    font-weight: 600;
    width: 100%;
}

button:hover {
    cursor: pointer;
}

.provider-btn {
    align-items: center;
    gap: 0.5em;
    box-shadow: 3px 3px 3px 1px rgba(0, 0, 0, .25);
}

.provider-btn:hover {
    transition: all 0.2s ease;
    box-shadow: 0px 0px 0px 0px rgba(0, 0, 0, .25);
}

.google-btn-logo {
    width: 1.375em;
}

/* === IDs === */


#logged-in-view {
    display: none;
}


.icon-btn {

    border: none;
    cursor: pointer;
    padding: 0;
    width: 1.875em;
}


.icon-img-btn{
    width:30px;
    height:20px;
}
#logged-in-view{
    display:flex;
    justify-content:center;
}

#sign-in-btn,#create-account-btn{
    border-radius:0px;
    border:6px solid rgb(16, 170, 134);
    color:#198754;
    font-weight:600px;
}
</style>

</head>

<body id="body"><center>
    <section id="logged-out-view">
        <div class="con">
            <h1 class="app-title">Hello Welcome! ðŸ˜Š</h1>
            <div class="provider-buttons">
                <button id="sign-in-with-google-btn" class="provider-btn">
                    
                    Sign in with Google
                </button>
            </div>
            <fieldset>
                <center>
                    <legend>
                        <h2>OR</h2>
                    </legend>
                </center>
            </fieldset>

            <div class="auth-fields-and-buttons">
                <input type="email" id="email-input" placeholder="Email">
                <input id="password-input" type="password" placeholder="Password">
                <button id="sign-in-btn" class="primary-btn">Sign in</button>
                <button id="create-account-btn" class="secondary-btn">Create Account</button>
            </div>
        </div>
    </section>

    <section id="logged-in-view">
        <div class="container2">
            <div class="container3">
                <div class="pro-log">
                   
                    <i class="fa-solid fa-arrow-right-from-bracket"></i><span  id="sign-out-btn"
                        class="icon-img-btn">Logout</span>
                </div>
                <div class="h">
                    <h1 id="greet"></h1>
                </div>

                <h1>Mango Leaf Disease Detector</h1>
                <form method="POST" enctype="multipart/form-data">
                    <div class="mb-3">
                        <input class="form-control" type="file" name="file" accept="image/*" required>
                    </div>
                    <button class="btn btn-success btn-lg" type="submit">Predict Disease</button>
                </form>
            </div>
        </div>
    </section>
</center>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA10gQJ8rGa825YVW_GUFYOxhRcrmgTziE",
            authDomain: "first-firebase-a71ca.firebaseapp.com",
            projectId: "first-firebase-a71ca",
            storageBucket: "first-firebase-a71ca.appspot.com",
            messagingSenderId: "596469610646",
            appId: "1:596469610646:web:b2bc92e3f91868c0686ab7"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        const loggedOutView = document.getElementById("logged-out-view");
        const loggedInView = document.getElementById("logged-in-view");
        const emailInput = document.getElementById("email-input");
        const passwordInput = document.getElementById("password-input");
        const signInBtn = document.getElementById("sign-in-btn");
        const createAccountBtn = document.getElementById("create-account-btn");
        const signInWithGoogleBtn = document.getElementById("sign-in-with-google-btn");
        const signOutBtn = document.getElementById("sign-out-btn");
        const profileImg = document.getElementById("profile-img");
        const userName = document.getElementById("user-name");

        // Firebase Auth State Change Listener
        onAuthStateChanged(auth, (user) => {
            if (user) {
                loggedOutView.style.display = "none";
                loggedInView.style.display = "block";
                userName.textContent = user.displayName || "User";
                profileImg.src = user.photoURL || "profile-placeholder.jpg";
            } else {
                loggedOutView.style.display = "block";
                loggedInView.style.display = "none";
            }
        });

        // Sign in with Google
        signInWithGoogleBtn.addEventListener("click", () => {
            signInWithPopup(auth, provider)
                .then((result) => {
                    console.log("Logged in with Google:", result.user);
                })
                .catch((error) => {
                    console.error("Google sign-in error:", error);
                });
        });

        // Sign in with email/password
        signInBtn.addEventListener("click", () => {
            const email = emailInput.value;
            const password = passwordInput.value;
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    console.log("User signed in:", userCredential.user);
                })
                .catch((error) => {
                    console.error("Sign-in error:", error);
                });
        });

        // Create new account
        createAccountBtn.addEventListener("click", () => {
            const email = emailInput.value;
            const password = passwordInput.value;
            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    console.log("Account created:", userCredential.user);
                })
                .catch((error) => {
                    console.error("Account creation error:", error);
                });
        });

        // Sign out
        signOutBtn.addEventListener("click", () => {
            signOut(auth)
                .then(() => {
                    console.log("User signed out");
                })
                .catch((error) => {
                    console.error("Sign-out error:", error);
                });
        });

        // File upload for disease prediction
        const uploadForm = document.getElementById("upload-form");
        uploadForm.addEventListener("submit", (e) => {
            e.preventDefault();
            const fileInput = document.getElementById("file-input");
            const file = fileInput.files[0];

            // Simulate prediction (this is where you'd integrate with your backend)
            // Redirect to result page (result.html)
          localStorage.setItem('predictionResult', 'Leaf has Mango Disease X. Please check with a specialist.');
            window.location.href = "templates\result.html"; // Redirect to result.html
        });
    </script>
</body>
</html>   